<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Stock Market Calculator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      --bg-color: #1a202c;
      --card-color: #2d3748;
      --text-color: #ffffff;
      --button-color: #22c55e;
    }
    body {
      background-color: var(--bg-color);
      color: var(--text-color);
    }
    .card {
      background-color: var(--card-color);
    }
    .button {
      background-color: var(--button-color);
    }
    /* Theme menu styles */
    #themeMenu {
      background-color: rgba(0, 0, 0, 0.6);
    }
    .theme-card {
      background-color: var(--card-color);
      padding: 1.5rem;
      border-radius: 1rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .theme-button {
      background-color: var(--button-color);
      text-align: center;
      padding: 0.75rem;
      font-weight: bold;
      border-radius: 0.5rem;
      transition: background-color 0.3s;
    }
    .theme-button:hover {
      opacity: 0.8;
    }
  </style>
</head>
<body onload="loadTheme()">

  <div class="max-w-md mx-auto mt-10 p-5 card rounded-lg shadow-lg">
    <h2 class="text-xl font-bold text-center mb-5">Stock Market Calculator</h2>

    <div class="mb-4">
      <label class="block text-sm font-medium">Cash Invested ($)</label>
      <input type="text" id="cashInvested" class="w-full p-2 mt-1 bg-gray-700 text-white border border-gray-600 rounded" 
             placeholder="Enter cash (e.g., 2M, 5B)" oninput="handleCashInput(this)">
    </div>

    <div class="mb-4">
      <label class="block text-sm font-medium">Purchase Price Per Share ($)</label>
      <input type="text" id="purchasePrice" class="w-full p-2 mt-1 bg-gray-700 text-white border border-gray-600 rounded" 
             placeholder="Enter purchase price">
    </div>

    <div class="mb-4">
      <label class="block text-sm font-medium">Current Price Per Share ($)</label>
      <input type="text" id="currentPrice" class="w-full p-2 mt-1 bg-gray-700 text-white border border-gray-600 rounded" 
             placeholder="Enter current price">
    </div>

    <button onclick="calculateProfit()" class="w-full button hover:opacity-80 text-white font-bold py-2 px-4 rounded">Calculate</button>

    <div class="mt-5 p-4 card rounded">
      <h3 class="text-lg font-bold">Results</h3>
      <p>Shares Owned: <span id="sharesOwned">0</span></p>
      <p>Total Value: <span id="totalValue">$0</span></p>
      <p>Profit/Loss: <span id="profitLoss" class="text-green-400">$0</span></p>
      <p>Percentage Change: <span id="percentageChange" class="text-green-400">0.00%</span></p>
    </div>
  </div>

  <!-- Hidden Theme Menu -->
  <div id="themeMenu" class="hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center">
    <div class="theme-card">
      <h3 class="text-lg font-bold mb-3 text-center text-white">Select Theme</h3>
      <button onclick="changeTheme('dark')" class="theme-button w-full mb-2">Dark Mode</button>
      <button onclick="changeTheme('orange')" class="theme-button w-full mb-2">Orange Theme</button>
      <button onclick="changeTheme('purple')" class="theme-button w-full">Purple Theme</button>
    </div>
  </div>

  <script>
    // Function to format the number with commas
    function formatNumber(num) {
      return num.toLocaleString();  // Convert number to a string with commas
    }

    // Parses the shorthand input (k, m, b, t) and returns the full number
    function parseInput(value) {
      value = value.trim().toLowerCase();

      // Replace commas with dots for decimal
      if (value.includes(',')) {
        value = value.replace(',', '.');
      }

      let multiplier = 1;
      if (value.endsWith('m')) {
        multiplier = 1e6; // million
        value = value.slice(0, -1); // Remove the 'm'
      } else if (value.endsWith('b')) {
        multiplier = 1e9; // billion
        value = value.slice(0, -1); // Remove the 'b'
      } else if (value.endsWith('k')) {
        multiplier = 1e3; // thousand
        value = value.slice(0, -1); // Remove the 'k'
      } else if (value.endsWith('t')) {
        multiplier = 1e12; // trillion
        value = value.slice(0, -1); // Remove the 't'
      }

      let num = parseFloat(value) * multiplier;

      if (!isNaN(num)) {
        return num;
      } else {
        return 0;
      }
    }

    // Handle input for the "Cash Invested" field
    function handleCashInput(input) {
      let rawValue = input.value.trim();
      if (rawValue === "") return;

      // Only apply shorthand conversions for "k", "m", "b", "t"
      let lastChar = rawValue.slice(-1).toLowerCase();
      if ("kmbt".includes(lastChar)) {
        let convertedValue = parseInput(rawValue);
        if (!isNaN(convertedValue) && convertedValue > 0) {
          input.value = formatNumber(convertedValue); // Format number with commas
        }
      } else {
        // Allow for regular input with numbers or decimals
        input.value = rawValue.replace(/,/g, '');  // Remove commas if any
      }
    }

    // Calculate profit based on the inputs
    function calculateProfit() {
      let cashInvestedRaw = document.getElementById('cashInvested').value.replace(/,/g, '');
      let purchasePrice = parseFloat(document.getElementById('purchasePrice').value.replace(',', '.'));
      let currentPrice = parseFloat(document.getElementById('currentPrice').value.replace(',', '.'));

      let cashInvested = parseInput(cashInvestedRaw);

      // Allow for valid decimals or numbers in other fields
      if (isNaN(cashInvested) || isNaN(purchasePrice) || isNaN(currentPrice) || purchasePrice <= 0) {
        alert('Please enter valid numbers');
        return;
      }

      let sharesOwned = cashInvested / purchasePrice;
      let totalValue = sharesOwned * currentPrice;
      let profitLoss = totalValue - cashInvested;
      let percentageChange = ((profitLoss / cashInvested) * 100).toFixed(2);

      document.getElementById('sharesOwned').textContent = formatNumber(sharesOwned);
      document.getElementById('totalValue').textContent = `$${formatNumber(totalValue)}`;
      document.getElementById('profitLoss').textContent = `$${formatNumber(profitLoss)}`;
      document.getElementById('profitLoss').className = profitLoss >= 0 ? 'text-green-400' : 'text-red-400';
      document.getElementById('percentageChange').textContent = `${percentageChange}%`;
      document.getElementById('percentageChange').className = profitLoss >= 0 ? 'text-green-400' : 'text-red-400';
    }

    function changeTheme(theme) {
      localStorage.setItem("selectedTheme", theme);
      if (theme === 'dark') {
        document.documentElement.style.setProperty('--bg-color', '#1a202c');
        document.documentElement.style.setProperty('--card-color', '#2d3748');
        document.documentElement.style.setProperty('--button-color', '#22c55e');
      } else if (theme === 'orange') {
        document.documentElement.style.setProperty('--bg-color', '#a34f00');
        document.documentElement.style.setProperty('--card-color', '#552a00');
        document.documentElement.style.setProperty('--button-color', '#d97706');
      } else if (theme === 'purple') {
        document.documentElement.style.setProperty('--bg-color', '#4b0082');
        document.documentElement.style.setProperty('--card-color', '#2a004d');
        document.documentElement.style.setProperty('--button-color', '#8b5cf6');
      }
      document.getElementById("themeMenu").classList.add("hidden");
    }

    function loadTheme() {
      let savedTheme = localStorage.getItem("selectedTheme");
      if (savedTheme) changeTheme(savedTheme);
    }
  </script>

</body>
</html>